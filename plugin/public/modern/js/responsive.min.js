var standby_status=-1,timerFormInitiated=-1;function initJsTranslationAddon(e){tstr_timer=e.timer,tstr_loading=e.loading,tstr_add_timer=e.add_timer,tstr_cancel=e.cancel,tstr_close=e.close,tstr_rename=e.rename,tstr_prompt_save_changes=e.prompt_save_changes,tstr_oops=e.oops,tstr_weekday=e.at_filter_weekday,tstr_weekend=e.at_filter_weekend,tstr_at_del=e.at_del,tstr_at_filter_title=e.at_filter_title,tstr_at_filter_short_desc=e.at_filter_short_desc,tstr_at_filter_desc=e.at_filter_desc,tstr_at_filter_day=e.at_filter_day,tstr_at_filter_include=e.at_filter_include,tstr_at_filter_exclude=e.at_filter_exclude,tstrings_no_cancel=e.no_cancel,tstrings_yes_delete=e.yes_delete,tstrings_yes=e.yes,tstrings_deleted=e.deleted,tstrings_cancelled=e.cancelled,tstrings_need_input=e.need_input,tstrings_install_package=e.install_package,tstrings_remove_package=e.remove_package,tstrings_update_package=e.update_package,tstrings_upload_package=e.upload_package,tstrings_upload_error=e.upload_error,tstr_bqe_add_url=e.bqe_add_url,tstr_bqe_name_url=e.bqe_name_url}function toggleFullRemote(){$("#symbolRemoteView").toggle(),$("#fullRemoteView").toggle()}function SetSpinner(){loadspinner=" \t<div class='page-loader-wrapper'> \t\t<div class='loader'> \t\t\t<div class='preloader'> \t\t\t\t<div class='spinner-layer pl--skinned'> \t\t\t\t\t<div class='circle-clipper left'> \t\t\t\t\t\t<div class='circle'></div> \t\t\t\t\t</div> \t\t\t\t\t<div class='circle-clipper right'> \t\t\t\t\t\t<div class='circle'></div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t</div> \t\t\t<p>"+tstr_loading+"...</p> \t\t</div> \t</div>"}function listTimers(){$("#timerdlgcont").html(loadspinner).load("ajax/timers #timers")}function set_epg_modal_content(e){$("#editTimerForm").load("ajax/edittimer"),$("#epgmodalcontent").html($(e).find("#epgcards").html())}function open_epg_dialog(e,t){$("#epgmodalcontent").html(loadspinner);let n="ajax/epgdialog?sref="+encodeURIComponent(e);$.get(n,set_epg_modal_content)}function open_epg_similar_dialog(e,t){$("#epgmodalcontent").html(loadspinner);let n="ajax/epgdialog?sref="+encodeURIComponent(e)+"&eventid="+t;$.get(n,set_epg_modal_content)}function load_channelsepg(e){return $("#channel_epg_container").load(e),!1}function load_subcontent(e){return $("[id^=sub_content_container]").load(e),!1}function loadtvcontent(e){return $("[id^=tvcontent]").load(e),!1}function load_maincontent(e){return(lastcontenturl!=e||e.indexOf("screenshot")>-1||e.indexOf("boxinfo")>-1)&&($("#content_container").load(e),lastcontenturl=e),!1}function load_maincontent_spin_force(e){let t='<div id="content_main">'+loadspinner+"</div>";return $("#content_container").html(t).load(e),lastcontenturl=e,!1}$((function(){timeredit_initialized||$("#editTimerForm").load("ajax/edittimer"),$("#navbar-collapse").on("show.bs.modal",(function(e){$("#navbar-collapse").removeAttr("style")})),$("#navbar-collapse").on("hide.bs.modal",(function(e){$("#navbar-collapse").addAttr("style","width:100%")})),$("#TimerModal").on("show.bs.modal",(function(e){if(!$("#TimerModal").data("bs.modal").isShown){let t;1!==timerFormInitiated&&initTimerEditForm();try{let n="metadata",i=e.relatedTarget.closest("[data-"+n+"]");t={},null!=i?t=JSON.parse(e.relatedTarget.closest("[data-"+n+"]").dataset[n]):(t.sref=e.relatedTarget.dataset.ref,t.id=e.relatedTarget.dataset.evid)}catch(e){console.log(e),t={}}t.sref&&t.id?addEditTimerEvent(t.sref,t.id):t.sref&&t.begin&&t.end?editTimer(t.sref,t.begin,t.end):addTimer()}})),$("#TimerModal").on("hidden.bs.modal",(function(e){})),autosize($("textarea.auto-growth")),$.Tools.epgsearch.activate(),$(document).keydown((function(e){(e.ctrlKey||e.cmdKey)&&70===e.keyCode&&(e.preventDefault(),$.Tools.epgsearch.showSearchBar()),(e.ctrlKey||e.cmdKey)&&69===e.keyCode&&(e.preventDefault(),$.Tools.epgsearch.showSearchBar())})),WebConfig(),setInterval((function(){getStatusInfo()}),3e3)}));var SSHelperObj=function(){var e;return{setup:function(){e=this,clearInterval(e.screenshotInterval),e.ssr_i=parseInt($("#ssr_i").val()),e.ssr_hd=$("#ssr_hd").is(":checked"),$("#dropdown").click((function(){testPipStatus()})),$("#screenshotbutton0").click((function(){testPipStatus(),grabScreenshot("all")})),$("#screenshotbutton1").click((function(){testPipStatus(),grabScreenshot("video")})),$("#screenshotbutton2").click((function(){testPipStatus(),grabScreenshot("osd")})),$("#screenshotbutton3").click((function(){testPipStatus(),grabScreenshot("pip")})),$("#screenshotbutton4").click((function(){testPipStatus(),grabScreenshot("lcd")})),$("button").click((function(){testPipStatus()})),$("#ssr_i").val(e.ssr_i),$("#screenshotspinner").addClass(GetLSValue("spinner","fa-spinner")),$("#ssr_hd").change((function(){testPipStatus(),e.ssr_hd=$("#ssr_hd").is(":checked"),webapi_execute("/api/setwebconfig?screenshot_high_resolution="+(e.ssr_hd?"true":"false")),grabScreenshot("auto")})),$("#ssr_i").change((function(){testPipStatus();let t=$("#ssr_i").val();webapi_execute("/api/setwebconfig?screenshot_refresh_time="+t),e.ssr_i=parseInt(t),$("#ssr_s").is(":checked")&&(clearInterval(e.screenshotInterval),e.setSInterval())})),$("#ssr_s").change((function(){testPipStatus();let t=$("#ssr_s").is(":checked");t?e.setSInterval():clearInterval(e.screenshotInterval),webapi_execute("/api/setwebconfig?screenshot_refresh_auto="+(t?"true":"false"))})),screenshotMode="all",grabScreenshot(screenshotMode),$("#ssr_s").is(":checked")&&e.setSInterval()},setSInterval:function(){e.screenshotInterval=setInterval((function(){testPipStatus(),grabScreenshot("auto")}),1e3*(e.ssr_i+1))}}},SSHelper=new SSHelperObj;function load_reboot_dialog(e,t){let n=loadspinner.replace("<p>"+tstr_loading+"...</p>","<p>"+tstr_loading+"...</p><p>"+t+"</p>");$("#responsivespinner").html(n)}function toggleLeftSideBar(){let e=$("body"),t=e.height(),n=$("#fullmaincontent");$("body").hasClass("ls-closed-manual")?(n.addClass("content"),n.removeClass("contentfull"),e.removeClass("ls-closed-manual"),$("#epgcard").height($("#leftsidemenu").height()-30+"px"),$("#topmenuheader,#mainfooter").show(),$("#togglefullscreen").html("fullscreen"),setTimeout((function(){load_tvcontent("ajax/multiepg?epgmode=tv")}),500)):(e.addClass("ls-closed-manual"),n.removeClass("content"),n.addClass("contentfull"),$("#epgcard").height(t+"px"),$("#topmenuheader,#mainfooter").hide(),$("#togglefullscreen").html("fullscreen_exit"),setTimeout((function(){load_tvcontent("ajax/multiepg?epgmode=tv")}),500))}function grabScreenshot(e){$("#screenshotimage").load((function(){$("#responsivespinnerscreenshot").hide()})),"auto"!=e?screenshotMode=e:e=screenshotMode,timestamp=(new Date).getTime(),SSHelper.ssr_hd?$("#screenshotimage").attr("src","/grab?format=jpg&mode="+e+"&t="+timestamp):$("#screenshotimage").attr("src","/grab?format=jpg&r=720&mode="+e+"&t="+timestamp),$("#screenshotimage").attr("style","max-height:60vh;"),"lcd"==e?$("#screenshotimage").attr("class","img-responsive center-block"):$("#screenshotimage").attr("class","img-responsive img-rounded center-block")}function setOSD(e){let t=current_ref=e.currservice_serviceref,n=current_name=e.currservice_station,i=tstr_stream+": "+n+"'><i class='material-icons'>ondemand_video</i></a>",a=tstr_stream+" ("+tstr_transcoded+"): "+n+"'><i class='material-icons'>phone_android</i></a>",s="",r="",o="";if(n&&((t.startsWith("1:0:")||t.startsWith("1:134:")||t.startsWith("4097:0:"))&&($("#osd__current-event__name").html(e.currservice_name),t.startsWith("1:0:0")?$("#osd__current-service").html("[ Movies ]"):($("#osd__current-event__time__start").html(e.currservice_begin||""),$("#osd__current-event__time__end").html(e.currservice_end||""),$("#osd__current-service").html(n),$("#osd__current-event__epg").off("click").click((function(){open_epg_dialog(t,n)})),$("#osd__current-event").off("click").click((function(){loadeventepg(e.currservice_id,t,"/images/default_picon.png")}))),e.transcoding&&(t.startsWith("1:0:1")||t.startsWith("1:134:1"))&&(s="<a href='#' onclick=\"jumper8002('"+t+"', '"+n+"')\"; title='"+a)),t.startsWith("1:0:0")||t.startsWith("4097:0:")))if(""===e.currservice_filename)i=tstr_stream+": "+n+"'>"+n+"</a>",r="<a href='#' title='"+i;else{let t=e.currservice_filename.replaceAll("'","%27").replaceAll('"',"%22");i=tstr_stream+": "+n+"'><i class='material-icons'>movie</i></a>",r="<a href='/web/ts.m3u?file="+t+"' target='_blank' title='"+i,o="<a href='/#movies' onclick='load_maincontent(\"ajax/movies\");'><b>"+n+"&nbsp;&nbsp;</b></a>",e.transcoding&&(s="<a href='#' onclick=\"jumper8003('"+t+"')\"; title='"+a)}$("#osd__current-event__stream").attr("href","/web/stream.m3u?ref="+t+"&name="+encodeURIComponent(n)),$("#volume-slider, #osd__current-volume").val(e.volume),$("#responsive_osd_transcoding").html(s),$("#responsive_osd_stream").html(r),$("#responsive_osd_current").html(o),$("#responsive_osd_cur_event").html("");try{$(".channel-list__channel").removeClass("channel--active"),$("#sref-"+t.replace(/:/g,"_")).addClass("channel--active")}catch(e){}}function loadeventepg(e,t,n){channelpicon=void 0!==n?n:null;let i="ajax/event?idev="+e+"&sref="+encodeURIComponent(t);$("#eventdescriptionII").load(i)}function loadtimeredit(e,t){let n="ajax/event?idev="+e+"&sref="+encodeURIComponent(t);$("#eventdescriptionII").load(n)}function initTimerEdit(e,t){initTimerBQ(e,(function(){$("#dirname").find("option").remove().end(),$("#dirname").append($("<option></option>").attr("value","None").text("Default"));for(let e in _locations){let t=_locations[e];$("#dirname").append($("<option></option>").attr("value",t).text(t))}$("#dirname").selectpicker("refresh"),$("#tagsnew").html("");for(let e in _tags){let t=_tags[e];$("#tagsnew").append("<input type='checkbox' name='"+t+"' value='"+t+"' id='tag_"+t+"'/><label for='tag_"+t+"'>"+t+"</label>")}$("#tagsnew > input").checkboxradio({icon:!1}),timeredit_initialized=!0,t()}))}function initTimerEditBegin(){$("#timerbegin").datetimepicker({format:"dd.mm.yy hh:ii",autoclose:!0,todayHighlight:!0,todayBtn:"linked",minuteStep:2,language:"de"}),$("#timerbegin").datetimepicker().on("changeDate",(function(e,t){""!=$("#timerend").val()&&$(this).datetimepicker("getDate")>$("#timerend").datetimepicker("getDate")&&showErrorMain(tstr_start_after_end)}))}function TimerConflict(e,t,n,i){let a="";e.sort((function(e,t){return e.begin-t.begin})),e.forEach((function(e){a+="<div class='row clearfix conflicting-timer'><div class='col-xs-12'> \t\t\t<div class='card'> \t\t\t\t<div class='header' style='padding: 10px 20px;'> \t\t\t\t\t<div class='row clearfix'> \t\t\t\t\t\t<div class='col-xs-12'>               <h2>                 <span role='button'>                   <a href='javascript:void(0);' onclick='toggleTimerStatus(\""+e.serviceref+'", "'+e.begin+'", "'+e.end+'"); this.closest(".conflicting-timer").classList.add("fade");\' class="link--skinned" title=\'Disable Timer\'>                     <i class=\'material-icons material-icons-centered material-icons-mg-right\'>alarm_off</i>                   </a>                 </span> \t\t\t\t\t\t\t  '+e.name+"                 <span style='opacity: 0.4;'> - "+e.servicename+"</span>               </h2> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t\t<div class='body'> \t\t\t\t\t\t<div class='row clearfix'> \t\t\t\t\t\t\t<div class='col-xs-12' style='margin: 10px 0 0;'>                 <p>"+e.realbegin+" - "+e.realend+"</p>               </div> \t\t\t\t\t\t</div> \t\t\t\t\t</div> \t\t\t\t</div> \t\t\t</div> \t\t</div></div> \t\t"})),$(".modal").modal("hide"),$("#timerconflictmodal").html(a),$("#TimerConflictModal").modal("show")}function cbAddTimerEvent(e){e.state&&($(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] .timer').remove(),$(".event[data-id="+e.eventId+'][data-ref="'+e.sRef+'"] div:first').append('<div class="timer">'+tstr_timer+"</div>"),showErrorMain(tstr_timer_added,!0))}function addTimerEvent(e,t,n,i){let a="/api/timeraddbyeventid?sRef="+e+"&eventid="+t;n&&(a+="&eit=0&disabled=0&justplay=1&afterevent=3"),webapi_execute_result(a,(function(a,s,r){!a&&r?TimerConflict(r,e,t,n):void 0!==i?i({sRef:e,eventId:t,justplay:n,state:a,txt:s}):showErrorMain(a?tstr_timer_added:s,!0)}))}function addTimer(e,t,n,i){current_serviceref="",current_begin=-1,current_end=-1,servicename="";let a=-1,s=-1,r="",o="",c="",l=0,d=0,m=isRadio(t);void 0!==e&&""!=e&&(a=e.begin,s=e.begin+e.duration,r=e.sref,servicename=e.channel,o=unEscape(e.title),c=unEscape(e.shortdesc),l=e.recording_margin_before,d=e.recording_margin_after,m=isRadio(r));let p=$("#bouquet_select > optgroup").length;$("#cbtv").prop("checked",!m),$("#cbradio").prop("checked",m);let u=function(){void 0!==t&&void 0!==n&&(r=t,o=n,"undefined"===$("#bouquet_select").val(t)&&$("#bouquet_select").append($("<option></option>").attr("value",r).text(n))),$("#timername").val(o),$("#description").val(c),$("#dirname").val("None"),$("#enabled").prop("checked",!0),$("#allow_duplicate").prop("checked",!0),$("#justplay").prop("checked",!1),$("#afterevent").val(3);for(let e=0;e<7;e++)$("#day"+e).prop("checked",!1);$("#tagsnew > input").prop("checked",!1).checkboxradio("refresh");let e=-1!==a?new Date(1e3*(Math.round(a)-60*l)):new Date;$("#timerbegin").datetimepicker("setDate",e);let i=-1!==s?new Date(1e3*(Math.round(s)+60*d)):new Date(e.getTime()+36e5);$("#timerend").datetimepicker("setDate",i),$("#bouquet_select").val(r),$("#bouquet_select").trigger("chosen:updated"),setTimerEditFormTitle(tstr_add_timer)};if(!timeredit_initialized||p<2)initTimerEdit(m,u);else{let e=$("#bouquet_select option:last").val();m!=isRadio(e)?initTimerEdit(m,u):u()}}function editTimer(e,t,n){e=decodeURIComponent(e),current_serviceref=e,current_begin=t,current_end=n;let i=isRadio(e);$("#cbtv").prop("checked",!i),$("#cbradio").prop("checked",i);let a=function(){timeredit_begindestroy&&(initTimerEditBegin(),timeredit_begindestroy=!1),$.ajax({url:"/api/timerlist",dataType:"json",success:function(i){if(i.result)for(let a in i.timers)if(timer=i.timers[a],timer.serviceref==e&&Math.round(timer.begin)==Math.round(t)&&Math.round(timer.end)==Math.round(n)){if($("#timername").val(timer.name),$("#description").val(timer.description),$("#bouquet_select").val(timer.serviceref),$("#bouquet_select").trigger("chosen:updated"),timer.serviceref!==$("#bouquet_select").val()&&($("#bouquet_select").append($("<option></option>").attr("value",timer.serviceref).text(timer.servicename)),$("#bouquet_select").val(timer.serviceref)),$("#dirname").val(timer.dirname),timer.dirname!==$("#dirname").val()){let e="<option value='"+timer.dirname+"'>"+timer.dirname+"</option>";$("#dirname").append(e),$("#dirname").val(timer.dirname)}$("#enabled").prop("checked",0==timer.disabled),$("#allow_duplicate").prop("checked",timer.allow_duplicate),$("#justplay").prop("checked",timer.justplay),$("#afterevent").val(timer.afterevent);let e=timer.repeated;for(let t=0;t<7;t++)$("#day"+t).prop("checked",1==(1&e)),e>>=1;$("#tagsnew > input").prop("checked",!1);let t=timer.tags.split(" ");for(let e=0;e<t.length;e++){let n=t[e].replace(/\(/g,"_").replace(/\)/g,"_").replace(/\'/g,"_");n.length>0&&($("#tag_"+n).length?$("#tag_"+n).prop("checked",!0).checkboxradio("refresh"):$("#tagsnew").append("<input type='checkbox' checked='checked' name='"+n+"' value='"+n+"' id='tag_"+n+"'/><label for='tag_"+n+"'>"+n+"</label>"))}$("#tagsnew > input").checkboxradio({icon:!1}),$("#timerbegin").datetimepicker("setDate",new Date(1e3*Math.round(timer.begin))),$("#timerend").datetimepicker("setDate",new Date(1e3*Math.round(timer.end)));let n=2===timer.state;n?($("#timerbegin").datetimepicker("destroy"),timeredit_begindestroy=!0,$("#timerbegin").addClass("ui-state-disabled"),$("#timername").addClass("ui-state-disabled"),$("#dirname option").not(":selected").attr("disabled","disabled"),$("#bouquet_select option").not(":selected").attr("disabled","disabled")):($("#timername").removeClass("ui-state-disabled"),$("#timerbegin").removeClass("ui-state-disabled"),$("#dirname option").removeAttr("disabled"),$("#bouquet_select option").removeAttr("disabled")),$("#timerbegin").prop("readonly",n),$("#timername").prop("readonly",n),void 0!==timer.vpsplugin_enabled&&(timer.vpsplugin_enabled,0)?(console.debug(timer.vpsplugin_enabled),$("#vpsplugin_enabled").prop("checked",timer.vpsplugin_enabled),$("#vpsplugin_safemode").prop("checked",!timer.vpsplugin_overwrite),$("#has_vpsplugin1").show(),checkVPS()):$("#has_vpsplugin1").hide(),void 0!==timer.always_zap?($("#always_zap1").show(),$("#always_zap").prop("checked",1==timer.always_zap),$("#justplay").prop("disabled",1==timer.always_zap)):$("#always_zap1").hide(),setTimerEditFormTitle(tstr_edit_timer+" - "+timer.name);break}}})};if(timeredit_initialized){let e=$("#bouquet_select option:last").val();i!=isRadio(e)?initTimerEdit(i,a):a()}else initTimerEdit(i,a)}function changeMoviesort(e){MLHelper.SortMovies(e),MLHelper.ChangeSort(e),MLHelper.ReadMovies(),lastcontenturl="",load_maincontent_spin("ajax/movies")}function changeMoviesortSearch(e){MLHelper.SortMovies(e),MLHelper.ChangeSort(e),MLHelper.ReadMovies(),load_maincontent_spin_force(lastcontenturl)}function initTimerEditForm(){1!==timerFormInitiated&&(timerFormInitiated=1,addTimer(),element=document.getElementById("editTimerForm"),$("#timereditmodal").html(element))}function setTimerEditFormTitle(e){$("#timerEditTitle").html(e)}function setVolume(e){$.ajax("web/vol?set=set"+e),getStatusInfo()}function toggleMute(){$.ajax("web/vol?set=mute"),getStatusInfo()}function CallEPGResponsive(e){load_tvcontent_spin(e)}function CallEPG(){$("#myepgbtn2").click((function(){$("#tvcontent").load("ajax/multiepg?epgmode=radio")})),$("#myepgbtn3").click((function(){$("#tvcontent").load("ajax/multiepg?epgmode=tv")})),$("#tvbutton").buttonset(),$("#tvcontent").load("ajax/multiepg?epgmode=tv")}function myEPGSearch(){let e=$("#epgSearchTVRadio").val(),t=$("#myepgbtn0").is(":checked")?"&full=1":"",n=$("#myepgbtn1").is(":checked")?"&bouquetsonly=1":"",i="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+n,a=$(window).width()-100,s=$(window).height()-100,r={};r[tstr_close]=function(){$(this).dialog("close")},r[tstr_open_in_new_window]=function(){$(this).dialog("close"),open_epg_search_pop(e,t)},load_dm_spinner(i,tstr_epgsearch,a,s,r)}getStatusInfo=function(){$("#osd__connection").toggle(!navigator.onLine),navigator.onLine&&owif.api.getStatusInfo().then((function(e){let t="";if(1==e.muted?(mutestatus=1,t="<a href='#' onclick='toggleMute(); return false;'><i class='material-icons'>volume_off</i></a>"):(mutestatus=0,t="<a href='#' onclick='toggleMute(); return false;'><i class='material-icons'>volume_up</i></a>"),$("#responsive_mute_status").html(t),setOSD(e),"true"==e.isRecording){let t=e.Recording_list.split("\n"),n=0,i="";for(let e in t)""!=t[e]&&(n+=1,i+="<li> <a href='/#timers' onclick='load_maincontent(\"ajax/timers\");' data-dismiss='modal'>"+t[e]+"</a></li><hr />");$("#recmodalcontent").html(i),$("#osd__active-recordings .label-count").text(n).parent().show()}else $("#osd__active-recordings").hide();if("true"==e.isStreaming){let t=e.Streaming_list.split("\n"),n=0,i="";for(let e in t)""!=t[e]&&(n+=1,i+="<li>"+t[e]+"</li><hr/>");$("#streammodalcontent").html(i),$("#osd__active-streams .label-count").text(n).parent().show()}else $("#osd__active-streams").hide();$("body").toggleClass("standby-mode","true"===e.inStandby)}))},$.Tools={};var $searchBar=$(".search-bar-epg"),$searchBarMovie=$(".search-bar-movie");function gotEPGSearch(){let e=$("#epgsearchtext").val(),t=$("#myepgbtn0").is(":checked")?"&full=1":"",n=$("#myepgbtn1").is(":checked")?"&bouquetsonly=1":"",i="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+n;$("#epgSearch").val(""),load_maincontent(i),lastcontenturl=""}function closeMessageModal(){$("#messageSentResponse").html("")}function sendModalMessage(){let e=$("#messageText").val(),t=$("#messageType").val(),n=$("#messageTimeout").val();$.ajax({url:"/api/message?text="+e+"&type="+t+"&timeout="+n,dataType:"json",cache:!1,success:function(e){$("#messageSentResponse").html('<div class="alert alert-info">'+e.message+"</div>"),0==t&&(MessageAnswerCounter=n,setTimeout(countdowngetMessage,1e3))}}),$("#messageText").val(""),$("#messageType").val(1),$("#messageType").selectpicker("refresh"),$("#messageTimeout").val("30"),$("#messageTimeout").removeClass("active"),$("#messageText").addClass("active")}function btn_saveTimer(){let e=moment($("#timerend").val(),"DD.MM.YYYY hh:mm").unix(),t=0;$('[name="repeated"]:checked').each((function(){t+=parseInt($(this).val())}));let n="";$('[name="tagsnew"]:checked').each((function(){""!=n&&(n+=" "),n+=$(this).val()}));let i={sRef:$("#bouquet_select").val(),end:e,name:$("#timername").val(),description:$("#description").val(),disabled:$("#enabled").is(":checked")?"0":"1",allow_duplicate:$("#allow_duplicate").is(":checked")?"1":"0",afterevent:$("#afterevent").val(),tags:n,repeated:t};if($("#always_zap").is(":checked")?(i.always_zap="1",i.justplay="0"):i.justplay=$("#justplay").is(":checked")?"1":"0","None"!=$("#dirname").val()&&(i.dirname=$("#dirname").val()),$("#has_vpsplugin1").is(":hidden")||(i.vpsplugin_enabled=$("#vpsplugin_enabled").is(":checked")?"1":"0",i.vpsplugin_overwrite=$("#vpsplugin_safemode").is(":checked")?"0":"1"),timeredit_begindestroy)i.begin=Math.round(current_begin);else{let e=moment($("#timerbegin").val(),"DD.MM.YYYY hh:mm").unix();i.begin=e}let a=!1;""==current_serviceref?$.ajax({async:!1,dataType:"json",cache:!1,url:"/api/timeradd?",data:i,success:function(e){if(e.result)a=!0;else if(e.conflicts){let t="Timer Conflicts:<br>";e.conflicts.forEach((function(e){t+=e.name+" / "+e.servicename+" / "+e.realbegin+" - "+e.realend+"<br>"})),showErrorMain(t)}else showErrorMain(e.message)}}):(i.channelOld=current_serviceref,i.beginOld=Math.round(current_begin),i.endOld=Math.round(current_end),$.ajax({async:!1,dataType:"json",cache:!1,url:"api/timerchange?",data:i,success:function(e){if(e.result)a=!0;else if(e.conflicts){let t="Timer Conflicts:<br>";e.conflicts.forEach((function(e){t+=e.name+" / "+e.servicename+" / "+e.realbegin+" - "+e.realend+"<br>"})),$("#error").text(t)}else $("#error").text(e.message)}})),a&&reloadTimers&&lastcontenturl.startsWith("ajax/timers")&&(lastcontenturl="",setTimeout((function(){load_maincontent("ajax/timers")}),500))}function WebConfig(){$("#myepgbtn0").change((function(){let e=$("#myepgbtn0").is(":checked")?"1":"0";$.get("api/setwebconfig?epgsearch_full="+e)})),$("#myepgbtn1").change((function(){let e=$("#myepgbtn1").is(":checked")?"1":"0";$.get("api/setwebconfig?epgsearch_only_bq="+e)})),$("#remotegrabscreen1").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?rcu_screenshot="+e)})),$("#remotecontrolview").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?rcu_full_view="+e),toggleFullRemote()})),$("#minmovielist").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?minmovielist="+e),lastcontenturl.startsWith("ajax/movies")&&load_maincontent_spin_force(lastcontenturl)})),$("#mintimerlist").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?mintimerlist="+e),"ajax/timers"===lastcontenturl&&(lastcontenturl="",load_maincontent("ajax/timers"))})),$("#minepglist").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?minepglist="+e)})),$("#zapstream").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?zapstream="+e)})),$("#showpicons").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?showpicons="+e),$("#showpiconbackground").prop("disabled",!e)})),$("#showpiconbackground").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?showpiconbackground="+e)})),$("#showiptvchannelsinselection").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?showiptvchannelsinselection="+e)})),$("#screenshotchannelname").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?screenshotchannelname="+e)})),$("#thememodebtn").change((function(){let e=$(this).is(":checked")?$(this).val():"supabright";$("body").removeClass((function(e,t){return(t.match(/(^|\s)theme--\S+/g)||[]).join(" ")})),$(this).is(":checked")?$("body").addClass("theme--"+e):$("body").addClass("theme--supabright"),$.get("api/setthememode?themeMode="+e)})),$("#nownext_columns").change((function(){let e=$(this).is(":checked")?"1":"0";$.get("api/setwebconfig?nownext_columns="+e)}))}function showErrorMain(e,t){let n="error";!0!==(t=void 0!==t?t:"False")&&"True"!==t&&"true"!==t||(n="success"),""!==e?swal("",e,n):$("#statuscont").hide()}function deleteTimer(e,t,n,i){let a=decodeURIComponent(i);swal({title:tstr_del_timer,text:a,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:tstrings_yes_delete,cancelButtonText:tstrings_no_cancel,animation:"none"},(function(i){i&&webapi_execute("/api/timerdelete?sRef="+e+"&begin="+t+"&end="+n,(function(){$("#"+t+"-"+n).remove()}))}))}function deleteMovie(e,t,n){swal({title:tstr_del_recording,text:n,type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:tstrings_yes_delete,cancelButtonText:tstrings_no_cancel,closeOnConfirm:!1,animation:"none"},(function(i){i&&webapi_execute_movie("/api/moviedelete?sRef="+e,(function(e){e&&(swal(tstrings_deleted,n,"success"),$("#"+t).remove())}))}))}function renameMovie(e,t){swal({title:tstr_ren_recording,text:t,type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"none",inputPlaceholder:t,inputValue:t,input:"text"},(function(n){return!1!==n&&n!==t&&(""===n?(swal.showInputError(tstrings_need_input),!1):(webapi_execute_movie("/api/movierename?sRef="+e+"&newname="+n),void showErrorMain(n,!0)))}))}function closeSideBar(){let e=$("body");if(e.width()<$.AdminBSB.options.leftSideBar.breakpointWidth){let t=$("#leftsidebarin");e.addClass("ls-closed"),t.fadeIn()}else e.removeClass("ls-closed")}function CallEPG(){$("#myepgbtn2").click((function(){$("#tvcontent").load("ajax/multiepg?epgmode=radio")})),$("#myepgbtn3").click((function(){$("#tvcontent").load("ajax/multiepg?epgmode=tv")})),$("#tvbutton").buttonset(),$("#tvcontent").load("ajax/multiepg?epgmode=tv"),"pepper-grinder"==theme&&$("#tvcontent").addClass("ui-state-active")}function myEPGSearch(){let e=$("#epgSearchTVRadio").val(),t=$("#myepgbtn0").is(":checked")?"&full=1":"",n=$("#myepgbtn1").is(":checked")?"&bouquetsonly=1":"",i="ajax/epgdialog?sstr="+encodeURIComponent(e)+t+n,a=$(window).width()-100,s=$(window).height()-100,r={};r[tstr_close]=function(){$(this).dialog("close")},r[tstr_open_in_new_window]=function(){$(this).dialog("close"),open_epg_search_pop(e,t)},load_dm_spinner(i,tstr_epgsearch,a,s,r)}$.Tools.epgsearch={activate:function(){let e=this;$(".js-search-epg").on("click",(function(){e.showSearchBar()})),$searchBar.find(".close-search").on("click",(function(){e.hideSearchBar()})),$searchBar.find(".start-search").on("click",(function(){e.startSearch()})),$searchBar.find('input[type="text"]').on("keyup",(function(t){27==t.keyCode?e.hideSearchBar():13==t.keyCode&&e.startSearch()}))},showSearchBar:function(){$searchBar.addClass("open"),$searchBar.find('input[type="text"]').focus()},hideSearchBar:function(){$searchBar.removeClass("open"),$searchBar.find('input[type="text"]').val("")},startSearch:function(){$("body").hasClass("ls-closed-manual")&&toggleLeftSideBar(),gotEPGSearch(),this.hideSearchBar()}};